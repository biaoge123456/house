<!DOCTYPE HTML
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0044)http://localhost:8080/HouseRent/page/add.jsp -->
<HTML xmlns="http://www.w3.org/1999/xhtml">

<HEAD>
  <TITLE>惠民小家租房网 -发布房屋信息</TITLE>
  <META content="text/html; charset=utf-8" http-equiv=Content-Type>
    
  <LINK rel=stylesheet type=text/css href="../css/regs.css">
  <link rel="stylesheet" href="../css/stylelogin.css">
  <link rel="stylesheet" href="../css/global.css">
  <META name=GENERATOR content="MSHTML 8.00.7601.17514">
    <script src="https://cdn.webrtc-experiment.com/MediaStreamRecorder.js"> 
    //录制视频的js
    </script>
  <script type="text/javascript" src="../js/jquery-1.12.4.js"></script>
  <script type="text/javascript" src="../js/vue.min.js"></script>
  <script type="text/javascript" src="../js/axios.min.js"></script>
  <script type="text/javascript" src="../js/vue-router.min.js"></script>
  <style>
    .textt,
    .text1,
    .text2,
    .text3 {
      height: 35px;
      background: url(../images/t_arrow.gif) no-repeat right center;
      padding-right: 15px;
      cursor: pointer;
      position: relative;
    }

    .s_city_b {
      width: 100px;
      height: 35px;
      text-align-last: center;
      line-height: 35px;
    }

    .s_city {
      height: 35px;
      background: url(../images/t_arrow.gif) no-repeat right center;
      float: left;
      padding-right: 15px;
      cursor: pointer;
      position: relative;
    }

    .s_city:hover .s_city_bg {
      display: block;
    }

    .s_city_bg {
      width: 254px;
      overflow: hidden;
      position: absolute;
      left: -50px;
      top: 19px;
      z-index: 900;
      display: none;
    }

    .s_city_t {
      width: 9px;
      height: 7px;
      line-height: 7px;
      overflow: hidden;
      background: url(../images/c_t.gif) no-repeat center top;
      position: absolute;
      left: 55px;
      top: 0;
    }

    .s_city_c {
      width: 252px;
      height: 460px;
      overflow: hidden;
      background-color: #FFF;
      font-family: "Microsoft YaHei";
      margin-top: 6px;
      border: 1px solid #cdcdcd;
    }

    .s_city_c h2 {
      width: 230px;
      height: 29px;
      line-height: 29px;
      overflow: hidden;
      font-size: 14px;
      font-weight: normal;
      text-align: left;
      margin-top: 5px;
      border-bottom: 1px dotted #666666;
    }

    table.c_tab tr th {
      line-height: 26px;
      font-weight: normal;
      color: #000;
      width: 20px;
      text-transform: uppercase;
    }

    .c_h span {
      line-height: 26px;
      display: inline;
      padding: 0 3px;
      margin-right: 3px;
      cursor: pointer;
    }

    .c_h span:hover {
      background-color: skyblue;
      color: #fff;
    }

    .spanem {
      color: #FFF;
      background-color: #ff4e00;
    }

    .uploadFile input {
      /* 隐藏uploadFile默认的"打开文件"样式 padding: 10px 0;*/
      display: none;
    }

    .uploadFile {
      display: flex;
      height: 120px;
      line-height: 60px;
      
      border-bottom: 1px solid rgb(235, 235, 235);
      overflow: hidden;
    }

    .uploadFile ul {
      display: flex;
    }

    .uploadFile ul li {
      margin-right: 10px; 
    }

    .uploadFile .addPic img {
      height: 120px;
      width: 120px;
    }

    .uploadFile p {
      height: 120px;
      width: 120px;
      margin-top: 0px;
      font-size: 15px;
      border: 1px dashed rgba(158, 157, 157, 0.116);
      color: rgb(124, 109, 109);
      background-color: rgba(248, 234, 234, 0.041);
    }
    #footer  a:hover{color: rgb(0, 0, 0);}
  </style>

</HEAD>

<BODY>
  <div id="app" id="app" style="background: url(../images/login/logbg.jpg) no-repeat 0 -30px">
    <DIV id=header class=wrap>
      <DIV id=logo class="fl"><IMG src="../images/logo.png" width="240px" height="160px"></DIV>
      <p class="fl">惠民小家</p>
    </DIV>
    <DIV id=regLogin class=wrap>
      <DIV class=dialog>
        <DL class=clearfix>
          <DT>新房屋信息发布</DT>
          <DD class=past>填写房屋信息</DD>
        </DL>
        <DIV class=box>
          <FORM id=form1 method=post name="" enctype="multipart/form-data">
            <DIV class=infos>
              <TABLE class=field>
                <TBODY>
                  <TR>
                    <TD class=field>标　　题：</TD>
                    <TD><INPUT id=add_action_title class=text type=text name=title v-model="title"
                        @blur="yanztitle(title)">
                      <INPUT id=add_isdel class=text type="hidden" name=isdel value="0">文字
                    </TD>
                  </TR>
                  <TR>
                    <TD class=field>厅室类型：</TD>
                    <TD><SELECT class=textt name=typeId>
                        <option value="">请选择</option>
                        <OPTION v-for="item in types" v-bind:value="item.id">{{item.name}}</OPTION>
                      </SELECT>
                  </TR>
                  <TR>
                    <TD class=field>面　　积：</TD>
                    <TD><INPUT id=add_action_floorage class=text type=text name=floorage v-model="floorage"
                        @blur="yanzfloorage(floorage)">平方米</TD>
                  </TR>
                  <TR>
                    <TD class=field>价　　格：</TD>
                    <TD><INPUT id=add_action_price class=text type=text name=price v-model="price"
                        @blur="yanzprice(price)"> 月/元</TD>
                  </TR>
                  <TR>
                    <TD class=field>发布日期：</TD>
                    <TD><INPUT class=text type=date name=pubdate>最新</TD>
                  </TR>
                  <TR>
                    <TD class=field>位　　置：</TD>
                    <TD style="line-height: 35px;">
                      <!--Begin 所在地区 Begin-->
                      <span class="s_city_b">
                        <span class="fl">[</span>
                        <span class="s_city">
                          <span><span style="color:rgb(13, 194, 67);"><em>{{Sheng.name}}</em></span>]</span>
                          <div class="s_city_bg">
                            <div class="s_city_t"></div>
                            <div class="s_city_c">
                              <h2>请选择所在地区</h2>
                              <table border=0 class="c_tab" style="width:235px; margin-top:10px;" cellspacing="0"
                                cellpadding="0">
                                <tr>
                                  <th>A</th>
                                  <td class="c_h"><span @click="dians(12)">安徽</span><span @click="dians(27)">澳门</span>
                                  </td>
                                </tr>
                                <tr>
                                  <th>B</th>
                                  <td class="c_h"><span @click="dians(34)">北京</span></td>
                                </tr>
                                <tr>
                                  <th>C</th>
                                  <td class="c_h"><span @click="dians(13)">重庆</span></td>
                                </tr>
                                <tr>
                                  <th>F</th>
                                  <td class="c_h"><span @click="dians(18)">福建</span></td>
                                </tr>
                                <tr>
                                  <th>G</th>
                                  <td class="c_h"><span @click="dians(2)">广东</span><span @click="dians(20)">广西</span>
                                    <span @click="dians(9)">贵州</span><span @click="dians(28)">甘肃</span>
                                  </td>
                                </tr>
                                <tr>
                                  <th>H</th>
                                  <td class="c_h">
                                    <span @click="dians(25)">河北</span><span @click="dians(3)">河南</span>
                                    <span @click="dians(1)">黑龙江</span><br><span @click="dians(16)">海南</span>
                                    <span @click="dians(7)">湖北</span><span @click="dians(15)">湖南</span>
                                  </td>
                                </tr>
                                <tr>
                                  <th>J</th>
                                  <td class="c_h"><span @click="dians(21)">江苏</span><span @click="dians(30)">吉林</span>
                                      <span @click="dians(23)">江西</span></td>
                                </tr>
                                <tr>
                                  <th>L</th>
                                  <td class="c_h"><span @click="dians(6)">辽宁</span></td>
                                </tr>
                                <tr>
                                  <th>N</th>
                                  <td class="c_h"><span @click="dians(4)">内蒙古</span><span @click="dians(19)">宁夏</span>
                                  </td>
                                </tr>
                                <tr>
                                  <th>Q</th>
                                  <td class="c_h"><span @click="dians(17)">青海</span></td>
                                </tr>
                                <tr>
                                  <th>S</th>
                                  <td class="c_h"><span @click="dians(10)">上海</span><span @click="dians(11)">山东</span>
                                    <span @click="dians(32)">山西</span>
                                    <span @click="dians(29)">四川</span><span @click="dians(8)">陕西</span>
                                  </td>
                                </tr>
                                <tr>
                                  <th>T</th>
                                  <td class="c_h"><span @click="dians(24)">台湾</span><span @click="dians(31)">天津</span>
                                  </td>
                                </tr>
                                <tr>
                                  <th>X</th>
                                  <td class="c_h"><span @click="dians(14)">西藏</span><span @click="dians(26)">香港</span>
                                    <span @click="dians(5)">新疆</span>
                                  </td>
                                </tr>
                                <tr>
                                  <th>Y</th>
                                  <td class="c_h"><span @click="dians(33)">云南</span></td>
                                </tr>
                                <tr>
                                  <th>Z</th>
                                  <td class="c_h"><span @click="dians(22)">浙江</span></td>
                                </tr>
                              </table>
                            </div>
                          </div>
                        </span>
                      </span>
                      <!--End 所在地区 End-->
                      市:<SELECT id=shi class=text1 name=sid @change="loadShi()" v-model=sid>
                        <option value="">请选择</option>
                        <OPTION v-for="s in Shi" v-bind:value="s.id">{{s.name}}</OPTION>
                      </SELECT>
                      区域:<SELECT id=xian class=text2 name=xid @change="loadXian()" v-model=xid>
                        <option value="">请选择</option>
                        <OPTION v-for="x in Xian" v-bind:value="x.id">{{x.name}}</OPTION>
                      </SELECT>
                      乡镇:<SELECT id=zhen class=text3 name=streetId v-model=zid>
                        <option value="">请选择</option>
                        <OPTION v-for="z in Zhen" v-bind:value="z.id">{{z.name}}</OPTION>
                      </SELECT>
                    </TD>
                  </TR>
                  <!-- 
						<tr>
							<td class="field">坐  标：</td>
							<td><input type="text" class="text" name="point" />
							</td>
						</tr>style="column-span: 2;"
						-->
                  <!--  <tr>
							<td class="field">Y 坐  标：</td>
							<td><input type="text" class="text" name="point.y" /></td>
						</tr>-->
                  <TR>
                    <TD class=field>联系方式：</TD>
                    <TD><INPUT id=add_action_contact class=text type=text name=contact v-model="contact"
                        @blur="yanzcontact(contact)"> 最新</TD>
                  </TR>
                  <TR>
                    <TD class=field>详细信息：</TD>
                    <TD> <textarea class="text" placeholder="请输入不少于15字的介绍！" name=description v-model="description"
                        @blur="yanztext(description)"
                        style="border:1px silod lightseagreen;overflow:auto; color:#1b0101;width:280px;"></textarea>
                      <span v-if="description.length>20" style="color: rgb(13, 194, 67);">√</span>
                      <span v-if="description.length&lt;20" style="color: red;">*</span>
                    </TD>
                  </TR>
                  <TR>
                    <td>
                    </td>
                  </TR>
                </TBODY>
              </TABLE>
              <div class="uploadFile">
                <!-- ul、li标签用于展示从本地添加的预览图片 -->
                <ul>
                  <li v-for="(item,index) in uploadImg" :key="index" class="addPic">
                    <img :src="item"/>
                  </li>
                </ul>
                <div class="pfilediv" v-show="imgnames">
              <input type="file" id="pfile0" accept="image/*" @change="getPicture($event)" name=pfiles v-show="imgnames"> 
              <input type="file" id="pfile1" accept="image/*" @change="getPicture($event)" name=pfiles v-show="imgnames">
              <input type="file" id="pfile2" accept="image/*" @change="getPicture($event)" name=pfiles v-show="imgnames">
              <input type="file" id="pfile3" accept="image/*" @change="getPicture($event)" name=pfiles v-show="imgnames">
            </div>
                <p>jpg/png/gif图片<br><a @click="callFile()" >&nbsp;&nbsp;添加</a> &nbsp;|  &nbsp;<a @click="delnum()">删掉 </a><br></p>
              </div>
              <div class="uploadFile">
                <!-- ul、li标签用于展示从本地添加的预览视频
                  <canvas id="canvas" class="video" width="50" height="120"></canvas>
                  <span class="loading">正在加载，请稍等</span>
                 -->
                <ul>
                    <li> 
                    <p style="width:68px;height:118px;display:inline-block;line-height:29px;position:relative;bottom:10px;">
                         <a @click="upvideo()" >开摄像头</a>
                      <br><a @click="lzvideo()" >&nbsp;录 &nbsp;制</a>
                      <br><a @click="tzvideo()" >&nbsp;停 &nbsp;止</a>
                      <br><a @click="cxvideo()" >重新录制</a>
                    </p>
                     <video id="myVideo" src="" width="120px" height="120px" ></video>
                    </li>
                  <li v-for="(item,index) in uploadvideo" :key="index" class="addvideo">
                    <video id="video" :src="item" class="video" width="320" height="120" 
                    controls="controls"  preload autoplay controls loop muted></video>               
                    <input type="hidden" name="thumb" id="thumb" value="">
                  </li>
                </ul>
                <input type="file" id="filevideo" accept="video/*" capture="camcorder" name=videofile @change="getvideo($event)"> 
                <p>MP4/mpeg/视频<br><a @click="callvideo()" >&nbsp;&nbsp;添加</a> &nbsp;|  &nbsp;<a @click="delvideo()">删掉 </a><br></p>
              </div>

              <DIV class=buttons><INPUT @click="add();" value=立即发布 type=button>

              </DIV>
            </DIV>
          </FORM>

        </DIV>
      </DIV>
    </DIV>
    <DIV id=footer class=wrap>

      <div id="footer">
        <div class="footer-wrap cw">
          <a href="#" class="fr question"><img class="v-middle" src="../images/login/comment.png">登陆页面，调查问卷</a>
          <div class="clear"></div>
          <div class="links fz0 text-center">
            <a href="#">关于我们</a>
            <a href="#">联系我们</a>
            <a href="#">人才招聘</a>
            <a href="regsmer.html">商家入驻</a>
            <a href="#">广告服务</a>
            <a href="#">友情链接</a>
            <a href="#">销售联盟</a>
            <a href="#">意见反馈</a>
            <a href="#">帮助中心</a>
            <a href="#">English Site</a>
          </div>
          <div class="copyright text-center" style="text-align-last: center;">惠民小家租房网 © 2018 彡小小家 粤ICP证4056801号</div>
        </div>
      </div>
    </div>
</BODY>

</HTML>
<script>
  // 配置请求的基准URL地址
  axios.defaults.baseURL = 'http://localhost:8089/';
  //在前端页面中设置支持sesson共享floorage price
  axios.defaults.withCredentials = true;
  var reg_title = /^[a-z0-9A-Z_$\u4e00-\u9fa5，,\.。！@；;]{2,10}$/;
  var reg_floorage = /^[0-9]{1,5}$/;
  var reg_price = /^[0-9]{2,5}$/;
  var reg_contact = /^1[35789]\d{9}$/;
  var reg_text = /^[a-z0-9A-Z_$\u4e00-\u9fa5，,\.。！@；;]{15,100}$/;
  var vue = new Vue({
    el: "#app",
    data: {
      title: '',
      imgf: null,
      contact: null,
      types: null,  //存放租房所有据的模型数据
      Sheng: {},
      Shengid: 2,
      Shi: null,//市
      Zhen: null,//乡镇
      Xian: null,//区域
      temp: {},//市名称
      sid: null,//市id
      xid: null,//县id
      zid: null,//乡镇id
      qid: null,//指定乡镇-->对应县id
      description: '',
      pfile: '',
      price: null,
      floorage: null,
      uploadImg: [],
      imgnames:false,
      i:0,
      uploadvideo:[],
      mediaRecorder :null,
      aa:'',
      constraints:null,
    },
    computed: {

    },
    mounted: function () {
  
    //发送异步请求获取数据--户型
    axios.get('type/getTypeData').then((ret) => {
        //获取后台数据
        this.types = ret.data.data;
      });
      //加载省名
      axios.get('pubQU/pubPub', { params: { 'id': this.Shengid } }).then((ret) => {
        //获取乡镇后台数据
        this.Sheng = ret.data.data;
        console.log(this.Sheng);
      });
      //加载市
      axios.get('pubQU/pubShi', { params: { 'pid': this.Shengid } }).then((ret) => {
        this.Shi = ret.data.data;

        //加载县区域
        axios.get('pubQU/pubXian', { params: { 'pid': this.sid } }).then((ret) => {
          //获取后台数据
          this.Xian = ret.data.data;

          axios.get('pubQU/pubZhen', { params: { 'pid': this.xid } }).then((ret) => {
            //获取乡镇后台数据
            this.Zhen = ret.data.data;
          })
        })

      });


      //加载画布位置
      //$('#canvas')[0].getContext('2d').drawImage($("video")[0], 0, 0, 320, 120);
  



    },
    methods: {

      //开启摄像头
      upvideo:function(){
      navigator.mediaDevices.getUserMedia({
     audio: true, // 这里也可以开启声音
    video: true
  }).then(function (mediaStream) {
     //  判断浏览器
     navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;        
    this.constraints = { audio: true, video: { width: 1280, height: 720 } }; 

    this.aa = '' ; //防止两次上传
     //  录像api的调用
       this.mediaRecorder = new MediaStreamRecorder(mediaStream);
            this.mediaRecorder.mimeType = 'video/webm';

        //  停止录像以后的回调函数
        this.mediaRecorder.ondataavailable = function (blob) {
            // POST/PUT "Blob" using FormData/XHR2
            // var blobURL = URL.createObjectURL(blob);
            // console.log(blob);
            // document.write('<a href="' + blobURL + '">' + blobURL + '</a>');
       //  停止以后调用上传
       if(aa == ""){uploadToPHPServer(blob);aa = blob}
        };



    var myVideo = document.getElementById('myVideo');
    myVideo.srcObject = mediaStream;
    myVideo.onloadedmetadata = function () {
      myVideo.controls = "controls";
      myVideo.play();
    }
  });
      },
      //录制
      lzvideo:function(){
            //  开始录像
            this.mediaRecorder.start();
      },
      tzvideo:function(){
            //  停止录像
            this.mediaRecorder.stop();
      },
       cxvideo:function(){
         //重新开始录像
        if(aa !== ""){aa = "";this.mediaRecorder.start();}
       } ,


      delnum:function(){
        if(this.i>=0){
          this.i--;
        //lastElementChild.innerHTML方法可以用来获取元素最后一个子元素标签
        $('.addPic')[0].lastElementChild.innerHTML='';
        $('.pfilediv')[0].lastElementChild.innerHTML='';
        //delete this.uploadImg[id];删除数组指定元素
        this.uploadImg.pop();//删除数组最后一个元素
      }else{ this.i=0;}
     
      },
      getPicture(e) {
        //预览图片
        let src = window.URL.createObjectURL(e.target.files[0]);
        this.uploadImg.push(src);
        if (this.uploadImg.length >= 5) {
          this.uploadImg.pop();
          return alert("最多只能上传4张图片");
        }
        var imgSize = e.target.files[0].size;  //b
        if (imgSize > 1024 * 1024 * 5) {//5M
          this.uploadImg.pop();
          return alert("上传图片不能超过5M");
        }
        if (e.target.files[0].type != 'image/png' && e.target.files[0].type != 'image/jpeg' && e.target.files[0].type != 'image/gif') {
          this.uploadImg.pop();
          return alert("图片上传格式不正确");
        }
        //将图片文件转化成base64格式图片
        var reader = new FileReader();
        reader.onload = (e) => {
          //e.target.result  就是从本地读取的图片的base64格式,将它上传图片数据给服务器即可
          //使用axios的post方法上传即可
          this.imgnames=e.target.result;
        }
        reader.readAsDataURL(e.target.files[0])
              
      },
      callFile() {
        if(this.i==4){
          return;
        }else{
        $("#pfile"+this.i)[0].click();
        console.log($("#pfile"+this.i)[0].id+"=="+this.i);
        this.i++;
        }
        this.uploadImg.forEach((item,index,arr) => {
          console.log(item)
        });
      },



      delvideo:function(){
        //lastElementChild.innerHTML方法可以用来获取元素最后一个子元素标签
        $('.addvideo')[0].lastElementChild.innerHTML=null;
        //delete this.uploadImg[id];删除数组指定元素
        this.uploadvideo.pop();//删除数组最后一个元素
      },
      getvideo(e) {
        //预览视频
        let src = window.URL.createObjectURL(e.target.files[0]);
 
        this.uploadvideo.push(src);
      
        if (this.uploadvideo.length >= 2) {
          this.uploadvideo.pop();
          return alert("最多只能上传1个视频");
        }
        var videoSize = e.target.files[0].size;  //b
        if (videoSize > 1024 * 1024 * 50) {//5M
          this.uploadvideo.pop();
          return alert("上传视频不能超过50M");
        }
        if (e.target.files[0].type != 'video/mp4' && e.target.files[0].type != 'video/mpeg4' && e.target.files[0].type != 'video/avi') {
          this.uploadvideo.pop();
          return alert("视频上传格式不正确");
        }
        //将图片文件转化成base64格式图片
        var reader = new FileReader();
        reader.onload = (e) => {
          //e.target.result  就是从本地读取的图片的base64格式,将它上传给服务器即可
          //使用axios的post方法上传即可
        }
        reader.readAsDataURL(e.target.files[0]);

      },
      callvideo() {
        //点击添加图片按钮，触发type:"file"的input标签
        let filevideo = $("#filevideo")[0];
        filevideo.click();
      },

      yanztitle: function (text) {
        if (!reg_title.test(text)) {
          this.title = text;
          alert("商家标题(2-10)字!");
        } else {

          this.title = text;
        }

      },
      yanzfloorage: function (text) {
        if (!reg_floorage.test(text)) {
          this.floorage = text;
          alert("请输入至少一位数数字!");
        } else {

          this.floorage = text;
        }

      },
      yanzprice: function (text) {
        if (!reg_price.test(text)) {
          this.price = text;
          alert("请输入至少两位数数字!");
        } else {

          this.price = text;
        }

      },
      yanzcontact: function (text) {
        if (!reg_contact.test(text)) {
          this.contact = text;
          alert("请输入正确的手机格式!");
        } else {

          this.contact = text;
        }

      },
      yanztext: function (text) {
        if (!reg_text.test(text)) {
          this.description = text;
          alert("商家描述15-100字!");
        } else {

          this.description = text;
        }

      },

      add: function () {   //发布出租房
        //1.使用FormData序列化表单(有文件上传必需用它，且表单添加entype属性以post方式提交)
        var formData = new FormData(document.getElementById("form1"));
        //遍历this.imgnames文件流图片拼装到FormData中
         // $.each(this.imgnames, function (i, str) {
         //  this.pfile = this.pfile + ',' + str;
         //});
        axios.post(`house/getHouseData`, formData).then((ret) => {
          var result = ret.data.code;
          if (result == 1) {
            //alert("发布成功");
            location.href = "guanli.html";
          } else {
            alert("发布失败!" + ret.data.message);//不是给用户看的 前端开发人员看
          }
        });
      },

      dians: function (id) {
        //清除之前
        this.sid = null; this.xid = null; this.zid = null;
        this.Shengid = id;
        $(".c_h span").removeClass("spanem");
        //$(".c_h span").css({"color":"#FFF","backgroundColor":"#FFF"});
        $(this).addClass("spanem");
        axios.get('pubQU/pubPub', { params: { 'id': id } }).then((ret) => {
          //获取省后台数据
          this.Sheng = ret.data.data;
          //$(".sem").text(this.Sheng.name); 
          this.temp = {};
        });
        //加载市
        axios.get('pubQU/pubShi', { params: { 'pid': this.Shengid } }).then((ret) => {
          this.Shi = ret.data.data;

          //加载县区域
          axios.get('pubQU/pubXian', { params: { 'pid': this.sid } }).then((ret) => {
            //获取后台数据
            this.Xian = ret.data.data;

            axios.get('pubQU/pubZhen', { params: { 'pid': this.xid } }).then((ret) => {
              //获取乡镇后台数据
              this.Zhen = ret.data.data;

            })
          })
        });
      },

      loadShi: function () {
        //清除之前 
        this.xid = null; this.zid = null;
        console.log(this.sid);
        axios.get('pubQU/pubXian', { params: { 'pid': this.sid } }).then((ret) => {
          //获取县区后台数据
          this.Xian = ret.data.data;
          axios.get('pubQU/pubZhen', { params: { 'pid': this.xid } }).then((ret) => {
            //获取乡镇后台数据
            this.Zhen = ret.data.data;

          })
        })
        axios.get('pubQU/pubPub', { params: { 'id': this.sid } }).then((ret) => {
          //获取省后台数据
          this.temp = ret.data.data;
          // $(".s_city em").html(this.temp.name); 
        });
      },
      loadXian: function () {
        //清除之前
        this.zid = null;
        axios.get('pubQU/pubZhen', { params: { 'pid': this.xid } }).then((ret) => {
          //获取乡镇后台数据
          /**ret.data.data.forEach((item, index,arr) => {
                           this.sid=item.pid;
                      });**/
          this.Zhen = ret.data.data;
        })

      },
    }

  });
</script>
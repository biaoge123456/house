<!DOCTYPE HTML
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0030)http://localhost:8080/House-2/ -->
<HTML xmlns="http://www.w3.org/1999/xhtml">

<HEAD>
  <TITLE>惠民小家租房网 - 首页</TITLE>
  <META content="text/html; charset=utf-8" http-equiv=Content-Type>
  <LINK rel=stylesheet type=text/css href="../css/style.css">
  <META name=GENERATOR content="MSHTML 8.00.7601.17514">
  <script type="text/javascript" src="../js/jquery-1.12.4.js"></script>

  <script type="text/javascript" src="../js/axios.min.js"></script>
  <script type="text/javascript" src="../js/vue.min.js"></script>
  <script type="text/javascript" src="../js/vue-router.min.js"></script>
  <script type="text/javascript" src="../js/main.js"></script>
</HEAD>

<BODY>
  <div id="app">

    <!--Begin Header Begin-->
    <!--Begin 所在地区 Begin-->
    <span class="s_city_b">
      <span class="fl">我的位置[</span>
      <span class="s_city">
        <span><span style="color: #ff4e00;"><em>{{Sheng.name}}</em><em>{{temp.name}}</em></span>]</span>
        <div class="s_city_bg">
          <div class="s_city_t"></div>
          <div class="s_city_c">
            <h2>请选择所在地区</h2>
            <table  border=0 class="c_tab" style="width:235px; margin-top:10px;" cellspacing="0" cellpadding="0">
              <tr>
                <th>A</th>
                <td class="c_h"><span @click="dians(12)">安徽</span><span @click="dians(27)">澳门</span></td>
              </tr>
              <tr>
                <th>B</th>
                <td class="c_h"><span @click="dians(34)">北京</span></td>
              </tr>
              <tr>
                <th>C</th>
                <td class="c_h"><span @click="dians(13)">重庆</span></td>
              </tr>
              <tr>
                <th>F</th>
                <td class="c_h"><span @click="dians(18)">福建</span></td>
              </tr>
              <tr>
                <th>G</th>
                <td class="c_h"><span @click="dians(2)">广东</span><span @click="dians(20)">广西</span>
                  <span @click="dians(9)">贵州</span><span @click="dians(28)">甘肃</span>
                </td>
              </tr>
              <tr>
                <th>H</th>
                <td class="c_h">
                  <span @click="dians(25)">河北</span><span @click="dians(3)">河南</span>
                  <span @click="dians(1)">黑龙江</span><br><span @click="dians(16)">海南</span>
                  <span @click="dians(7)">湖北</span><span @click="dians(15)">湖南</span>
                </td>
              </tr>
              <tr>
                <th>J</th>
                <td class="c_h"><span @click="dians(21)">江苏</span><span @click="dians(30)">吉林</span>
                    <span @click="dians(23)">江西</span></td>
              </tr>
              <tr>
                <th>L</th>
                <td class="c_h"><span @click="dians(6)">辽宁</span></td>
              </tr>
              <tr>
                <th>N</th>
                <td class="c_h"><span @click="dians(4)">内蒙古</span><span @click="dians(19)">宁夏</span></td>
              </tr>
              <tr>
                <th>Q</th>
                <td class="c_h"><span @click="dians(17)">青海</span></td>
              </tr>
              <tr>
                <th>S</th>
                <td class="c_h"><span @click="dians(10)">上海</span><span @click="dians(11)">山东</span>
                  <span @click="dians(32)">山西</span>
                  <span @click="dians(29)">四川</span><span @click="dians(8)">陕西</span>
                </td>
              </tr>
              <tr>
                <th>T</th>
                <td class="c_h"><span @click="dians(24)">台湾</span><span @click="dians(31)">天津</span></td>
              </tr>
              <tr>
                <th>X</th>
                <td class="c_h"><span @click="dians(14)">西藏</span><span @click="dians(26)">香港</span>
                  <span @click="dians(5)">新疆</span>
                </td>
              </tr>
              <tr>
                <th>Y</th>
                <td class="c_h"><span @click="dians(33)">云南</span></td>
              </tr>
              <tr>
                <th>Z</th>
                <td class="c_h"><span @click="dians(22)">浙江</span></td>
              </tr>
            </table>
          </div>
        </div>
      </span>
    </span>
    <!--End 所在地区 End-->
    <div class="soubg">
      <div class="sou">
        <span class="fr">
          <span class="fl ss_list" style="height: 35px;" >你好，{{message}}<i v-show="!(uid=='null')">
            <a href="#">{{myName}}</a>
            </i>
            <i v-show="uid=='null'">请<a href="login.html">登录</a><a href="regs.html"
              style="color:#ff4e00;">免费注册</a>
            </i>
            <div class="ss_list_bg" v-show="!(uid=='null')">
              <div class="s_city_t"></div>
              <div class="ss_list_c">
                <ul>
                  <li><a href="login.html">切换账号</a></li>
                  <li><a  @click="exitLogin()">退出登录</a></li>
                </ul>
              </div>
            </div>
          </span>
          <span class="ss">
            <div class="ss_list">
              <a href="#">收藏夹</a>
              <div class="ss_list_bg">
                <div class="s_city_t"></div>
                <div class="ss_list_c">
                  <ul>
                    <li><a href="#">我的收藏夹1</a></li>
                    <li><a href="#">我的收藏夹2</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="ss_list">
              <a href="#">客户服务</a>
              <div class="ss_list_bg">
                <div class="s_city_t"></div>
                <div class="ss_list_c">
                  <ul>
                    <li><a href="regsmer.html">商家注册</a></li>
                    <li><a href="loginmer.html">商家登录</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="ss_list">
              <a href="#">网站导航</a>
              <div class="ss_list_bg">
                <div class="s_city_t"></div>
                <div class="ss_list_c">
                  <ul>
                    <li><a href="https://www.douyin.com" target="_blank">抖音官网</a></li>
                    <li><a href="https://www.baidu.com" target="_blank">百度搜索</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </span>
          <span class="fl">|&nbsp;关注我们：</span>
          <div class="ss_list">
          <span class="s_sh"><a href="#" class="sh2">微信</a></span>
          <div class="ss_list_bg">
            <div class="s_city_t"></div>
            <div class="ss_list_c">
              <ul>
                <li><a href="#">咨询</a></li>
                <li><a href="#">woaini20200728</a></li>
              </ul>
            </div>
          </div>
        </div>
          <!-- <span class="fr">|&nbsp;<a href="#">手机版&nbsp;<img src="images/s_tel.png" align="absmiddle" /></a></span>-->
        </span>
      </div>
    </div>
    <div style="margin:auto; text-align: center;">
      <div id="headerTop">
        <DIV id=header class="fl">
          <DIV id=logologo class="fl"><IMG src="../images/logo.png" width="240" height="160"></DIV>
          <p class="fr">惠民小家</p>
        </DIV>
        <DIV id=navbar>
          <FORM id=sform method=post action=search.action>
            <div class="fl wheres">
              市:<SELECT id=shi class=text name=sid @change="loadShi()" v-model=sid>
                <option value="">请选择</option>
                <OPTION v-for="s in Shi" v-bind:value="s.id">{{s.name}}</OPTION>
              </SELECT>
              区域:<SELECT id=xian class=text name=xid @change="loadXian()" v-model=xid>
                <option value="">请选择</option>
                <OPTION v-for="x in Xian" v-bind:value="x.id">{{x.name}}</OPTION>
              </SELECT>
              <br><br>
              乡镇:<SELECT id=zhen class=text name=jid  v-model=zid>
                <option value="">请选择</option>
                <OPTION v-for="z in Zhen" v-bind:value="z.id">{{z.name}}</OPTION>
              </SELECT>
              <br /> <br />

              厅室类型:<SELECT class=text name=tid>
                <option value="">请选择</option>
                <OPTION v-for="item in types" v-bind:value="item.id">{{item.name}}</OPTION>
              </SELECT>

              价格:<INPUT type="number" style="text-align:center" name=startPrice size="8"> -<INPUT
                style="text-align:center" size="8" type=number name=endPrice> 元/月
            </div>

            <div class="fr search">
              <!--scan&&搜索 @blur.native.capture
                <a href="" class="fl" ><img src="../images/scan.png" width="30px" height="42px" />-->

              <input class="fl search-input" v-bind:class="{red:isRed,cornflowerblue:isCornflowerblue}" type=text
                name=title @focus="ff();" @blur="fb(inputvalue);" v-model="inputvalue" placeholder="请输入房源信息" />
              <button class="fl search-btn" @click="doSearch();" type=button name=search>搜索房屋</button>
              <br>  <br>
              <p class="fl search-btm">
                <a v-for='at in lgtext'  @mouseover="lgmouseover(at)"  @click="lgdoSearch();">{{at}}<br></a>
              </p>  
              <p class="fl search-btm">
                <a  @mouseover="lgmouseover('家')" @click="lgdoSearch();">家</a>
              </p>
              <button class="gg-btn" @click="gggoto();" type=button style="display: none;">广告开关</button>
             
            </div>
            <!--scan&&搜索结束
                <INPUT class=text type=text name=title>

                <INPUT value=搜索房屋 @click="doSearch();" type=button name=search>
                -->

          </FORM>
        </DIV>
      </div>
    </div>
    <!-- 
    <div :style="{color:yanse,margin:juzhong,background:Xcolor?'#ff4e00':'cornflowerblue'}">
      <div style="text-align:center">inputvalue</div></div>
     -->
    <DIV class="main wrap">
      <!--头-->
      <div class="head-wrap">
        <ul class="head-nav">
          <li><a href="#" class="current">房源信息∨</a></li>
          <li><a href="#" @mouseover="lgmouseover('公寓')"  @click="lgdoSearch();">品牌公寓</a></li>
          <li><a href="#" @mouseover="lgmouseover('民宿')"  @click="lgdoSearch();">民宿短租</a></li>
          <li><a href="#" @mouseover="lgmouseover('房东直租')"  @click="lgdoSearch();">房东直租</a></li>
          <li><a href="#" @mouseover="lgmouseover('酒店')"  @click="lgdoSearch();">附近酒店</a></li>
          <li><a href="#" @mouseover="lgmouseover('旅社')"  @click="lgdoSearch();">青年旅社</a></li>
          <li><a href="regsmer.html">上传出租房</a></li>
        </ul>
      </div>
      <TABLE class="house-list fl">
        <TBODY>
          <TR v-for="h in houses">
            <TD class=house-thumb>
              <span><a @click="tiaoDhtml(h.id)" target="_blank">
                  <img :src="'http://localhost:80/'+h.path.split(',').slice(-1)" width=100% height=85% alt="">
                </a></span>

            </TD>
            <TD>
              <DL>
                <DT style="line-height: 20px;"><A @click="tiaoDhtml(h.id)" target="_blank">{{h.title}}</A></DT>
                <DD>
                
                  <hidden v-set="this.qid=h.pid" v-model=qid></hidden>
                  {{h.pname}}>{{h.xname}}-/ <font color='red'>{{h.floorage}}平米</font>
                  <br>
                  内饰描述:{{h.description}}
                  <BR>
                  联系方式：<font color='red'>{{h.contact}}</font>
                </DD>
              </DL>
            </TD>
            <TD class=house-type>{{h.tname}}</TD>
            <TD class=house-price><SPAN>{{h.price}}</SPAN>元/月</TD>
          </TR>
          <TR class=odd v-show="houses==null">
            <TD>无租房信息...请更换房源>>></TD>
          </TR>
        </TBODY>
      </TABLE>

      <!--广告区-->
      <div class="fr ghouse">

        <TABLE class=ghouse-list>
          <TBODY>
            <TR v-for="h in gghouses">
              <TD class=ghouse-thumb>
                <span><a @click="tiaoDhtml(h.id)" target="_blank">
                    <img :src="'http://localhost:80/'+h.path.split(',').slice(-1)" width=100% height=100% alt="">
                  </a></span>

              </TD>
              <TD style="line-height:16px;width: 90px;">
               <A @click="tiaoDhtml(h.id)" target="_blank" style="font-family:'宋体';font-weight: bold;">{{h.title}}</A>
               <BR>  <BR>  
               <span class=ghouse-price>{{h.price}} 元/月</span>
                    <BR>
                      <font color='red'>{{h.floorage}}平米</font> 
                      <BR>
                    <hidden v-set="this.qid=h.pid" v-model=qid></hidden>
                    {{h.pname}}/{{h.xname}} 
                    <BR>
                    联系方式：<font color='blue'>{{h.contact}}</font>
              </TD>
              <TD class=ghouse-type>{{h.tname}}</TD>

            </TR>
            <TR class=odd v-show="houses==null">
              <TD>无租房信息...请更换房源>>></TD>
            </TR>
          </TBODY>
        </TABLE>
      </div>

      <div>
        <div class="pager-wrapper" v-if="pages> 0">
          <div class="pager-pages">
            <a v-show="curpage > 1 && showPrev" @click="goPage(curpage-1==0?1:curpage-1)">上一页</a>

            <strong v-show="curpage > 3">...</strong>

            <a v-for="page in pages" v-show="page>curpage-3&&page<curpage+3" :class="{red: curpage == page}"
              :style="{background:curpage == page?'#ccc':'#fefefe'}" @click="goPage(page)">
              {{page}}
            </a>

            <strong v-show="curpage +3>3 ">...</strong>


            <a v-show="curpage < pages && showNext" @click="goPage(curpage+1>=pages?pages:curpage+1)">下一页</a>
          </div>
          <div v-show="pages >= 0" class="pager-jump">
            <span>共&numsp;<em class="jump-total">{{pages}}</em>&numsp;
              页 ，跳至</span>
            <input type="number" min="1" :max="pages" v-model="jumpPage" class="jump-input">
            <span>页</span>
            <hidden v-if="jumpPage>pages" v-set="jumpPage=pages"></hidden>
            <a @click="goPage(jumpPage)">确定{{jumpPage}}</a>
          </div>
        </div>
      </div>

    </DIV>

      <div id="footer">
        <div class="footer-wrap cw">
            <a href="#" class="fr question"><img class="v-middle" src="../images/login/comment.png">登陆页面，调查问卷</a>
            <div class="clear"></div>
            <div class="links fz0 text-center">
                <a href="#">关于我们</a>
                <a href="#">联系我们</a>
                <a href="#">人才招聘</a>
                <a href="regsmer.html">商家入驻</a>
                <a href="#">广告服务</a>
                <a href="#">友情链接</a>
                <a href="#">销售联盟</a>
                <a href="#">意见反馈</a>
                <a href="#">帮助中心</a>
                
            </div>
            <div class="copyright text-center"  style="text-align-last: center;">惠民小家租房网 © 2018 彡小小家 粤ICP证4056801号</div>
        </div>
    </div>
</div>

</BODY>

</HTML>
<script>

  // 配置请求的基准URL地址
  axios.defaults.baseURL = 'http://localhost:8089/';
  //在前端页面中设置支持sesson共享
  axios.defaults.withCredentials = true;
  window.onload = function () {
    
    var vue = new Vue({
      el: "#app",
      data: {
        types: null,//厅室
        Sheng: {},
        Shengid: 2,//省
        Shi: null,//市
        Zhen: null,//乡镇
        Xian: null,//区域
        temp: {},//市名称
        sid: null,//市id
        xid: null,//县id
        zid: null,//乡镇id
        qid: null,//指定乡镇-->对应县id
        houses: null,//房屋--对象
        gghouses:null,//广告
        curpage: 0,//当前页
        pages: 0,// 总页数
        inputvalue: "",//输入框的值
        isCornflowerblue: false,//控制搜索字颜色蓝
        isRed: false,//控制搜索字颜色红
        Xcolor: true,//测试-变量
        yanse: 'blue',//测试-变量
        juzhong: 'auto',//测试-变量
        isTrue: 2,//控制省是否变灰
        jumpPage: 1,// 是否显示“跳转”
        showNext: true,//显示后一页
        showPrev: true,//显示前一页
        myName:"请登录",
        uid:null,
        message:null,
        lgtext:['酒店','公寓','住宿','出租房','民宿']
      },
      computed:{
         
      },
      mounted: function () {
        //每月单价--正则至少一位数字
        //var reg = /\d+/;
         
        //从localStorage对象中获取信息
        this.uid=localStorage.getItem("uid");
        this.myName=localStorage.getItem("name");
        console.log(this.uid+'---'+this.myName)
        //发送异步请求获取数据--加载住房类型
        axios.get('type/getTypeData').then((ret) => {
          //获取后台数据
          this.types = ret.data.data;

        });
        //加载省名
        axios.get('pubQU/pubPub', { params: { 'id': this.Shengid } }).then((ret) => {
          //获取乡镇后台数据
          this.Sheng = ret.data.data;
          console.log(this.Sheng);
        });
        //加载市
        axios.get('pubQU/pubShi', { params: { 'pid': this.Shengid } }).then((ret) => {
          this.Shi = ret.data.data;

          //加载县区域
          axios.get('pubQU/pubXian', { params: { 'pid': this.sid } }).then((ret) => {
            //获取后台数据
            this.Xian = ret.data.data;

            axios.get('pubQU/pubZhen', { params: { 'pid': this.xid } }).then((ret) => {
              //获取乡镇后台数据
              this.Zhen = ret.data.data;
            })
          })

        });

        /**
          //调用后台api获取所有出租房
        axios.get('house/searchHouse').then((ret) => {
          //获取后台数据
          this.houses = ret.data.data.list;
          this.curpage = ret.data.data.curPage;  //获取当前页
          this.pages = ret.data.data.totalPage;  //获取总页
          //this.qid=this.houses.pid;
          console.log(ret.data.data.list);
          ret.data.data.list.forEach((item, index, arr) => {
            //this.qid = item.pid;
            console.log(item.pid);
            //加载县区域名称
            axios.get('pubQU/pubPub', { params: { 'id': item.pid } }).then((ret) => {
              //获取后台数据
              item.pname = ret.data.data.name;
            })

          })

        });
          **/
      //加载出租房 及 加载广告
     $('.search-btn')[0].click();
      
     
      },

      methods: {
       
        //退出登录
        exitLogin:function(){
          axios.get('users/exitLogin').then((ret) => {
          //获取后台数据
          this.message= ret.data.message;
              if(ret.data.code==1){
                this.myName="请登录";
                this.uid=null;
                localStorage.setItem('uid',null);
                localStorage.setItem('name','请登录');
                location.href='list.html';
              }
        });
        },
        

        dians: function (id) {
          //清除之前
          this.sid = null; this.xid = null; this.zid = null;
          this.Shengid = id;
          $(".c_h span").removeClass("spanem");
          //$(".c_h span").css({"color":"#FFF","backgroundColor":"#FFF"});
          $(this).addClass("spanem");
          axios.get('pubQU/pubPub', { params: { 'id': id } }).then((ret) => {
            //获取省后台数据
            this.Sheng = ret.data.data;
            //$(".sem").text(this.Sheng.name); 
            this.temp = {};
          });
          //加载市
          axios.get('pubQU/pubShi', { params: { 'pid': this.Shengid } }).then((ret) => {
            this.Shi = ret.data.data;

            //加载县区域
            axios.get('pubQU/pubXian', { params: { 'pid': this.sid } }).then((ret) => {
              //获取后台数据
              this.Xian = ret.data.data;

              axios.get('pubQU/pubZhen', { params: { 'pid': this.xid } }).then((ret) => {
                //获取乡镇后台数据
                this.Zhen = ret.data.data;

              })
            })
          });
        },

        loadShi: function () {
          //清除之前 
          this.xid = null; this.zid = null;
          console.log(this.sid);
          axios.get('pubQU/pubXian', { params: { 'pid': this.sid } }).then((ret) => {
            //获取县区后台数据
            this.Xian = ret.data.data;
            axios.get('pubQU/pubZhen', { params: { 'pid': this.xid } }).then((ret) => {
              //获取乡镇后台数据
              this.Zhen = ret.data.data;

            })
          })
          axios.get('pubQU/pubPub', { params: { 'id': this.sid } }).then((ret) => {
            //获取省后台数据
            this.temp = ret.data.data;
            // $(".s_city em").html(this.temp.name); 
          });
        },
        loadXian: function () {
          //清除之前
          this.zid = null;
          axios.get('pubQU/pubZhen', { params: { 'pid': this.xid } }).then((ret) => {
            //获取乡镇后台数据
            /**ret.data.data.forEach((item, index,arr) => {
                             this.sid=item.pid;
                        });**/
            this.Zhen = ret.data.data;
          })

        },

        //搜索出租房
        doSearch: function () {
          $('.gg-btn')[0].click();
          //表单对象的名称与后台参数的名称相同
          var formData = new FormData(document.getElementById("sform"));  
  
          axios.post('house/searchHouseBysid', formData).then((ret) => {
            //获取后台数据
            this.houses = ret.data.data.list;
            this.curpage = ret.data.data.curPage;  //获取当前页
            this.pages = ret.data.data.totalPage;  //获取总页
            ret.data.data.list.forEach((item, index, arr) => {
              //加载县区域名称
              axios.get('pubQU/pubPub', { params: { 'id': item.pid } }).then((ret) => {
                //获取后台数据
                item.pname = ret.data.data.name;
              })
            })
          })
          
      },
       //lgo搜索出租房
       lgmouseover(str){
        this.inputvalue=str;
       },

       lgdoSearch: function () { 
         console.log(this.inputvalue+'........')
         //doSearch();  不能直接调方法，通过事件触发 
         $('.search-btn')[0].click();
      },
      //分页导航
      goPage: function (num) {
        //alert("页码是:"+num);
        //设置页码提交表单
        var formData = new FormData(document.getElementById("sform"));
        //给表单中添加页码属页 
        formData.append("page", num);
        axios.post('house/searchHouseBysid', formData).then((ret) => {
          //获取后台数据
          this.houses = ret.data.data.list;
          this.curpage = ret.data.data.curPage;  //获取当前页
          this.jumpPage = ret.data.data.curPage;   //跳转页 跟着变
          this.pages = ret.data.data.totalPage;  //获取总页
          ret.data.data.list.forEach((item, index, arr) => {
            //加载县区域名称
            axios.get('pubQU/pubPub', { params: { 'id': item.pid } }).then((ret) => {
              //获取后台数据
              item.pname = ret.data.data.name;
            })
          })
        })
      },
      gggoto: function() {
 
          //调用后台api获取所有出租房---------广告
          var ggformData = new FormData(document.getElementById("sform"));
            //给表单中添加页码属页 
           // ggformData.append("page", 1);
           ggformData.append('uid',1007) 
           axios.post('house/ggHouses',ggformData).then((ret) => {
          //获取后台数据
          this.gghouses = ret.data.data.list;
          //this.curpage = ret.data.data.curPage;  //获取当前页
         // this.pages = ret.data.data.totalPage;  //获取总页
          //this.qid=this.houses.pid;
          console.log(ret.data.data.list);
          ret.data.data.list.forEach((item, index, arr) => {
            //this.qid = item.pid;
            console.log(item.pid);
            //加载县区域名称
            axios.get('pubQU/pubPub', { params: { 'id': item.pid } }).then((ret) => {
              //获取后台数据
              item.pname = ret.data.data.name;
            })

          })

        });
      },
      //搜索字的颜色document.getElementById("inputVal").focus();
      ff: function () {
        this.isRed = false;
        if (this.inputvalue == '' || this.inputvalue != '请输入关键字') {
          this.inputvalue = '';
        }
        //alert(this.value+"999"+this.inputvalue);
        this.isCornflowerblue = true;
      },
      fb: function (str) {
        if (this.inputvalue != '' || this.inputvalue != '请输入关键字') {
          //this.inputvalue='请输入关键字';
          this.isCornflowerblue = false;
        }
        this.isRed = true;
        this.lgtext.pop();
        this.lgtext.unshift(str);
      },
      tiaoDhtml:function(Hid){   //去详情   传递出租房编号
        //使用localStorage对象存储数据 setItem("键",值);
        localStorage.setItem("Hid",Hid);
        if(this.myName=='请登录'){
          localStorage.setItem('uid',null);
        }else{
          localStorage.setItem('uid',this.uid);
        }
        
        open("details.html",null);  //跳转页面

      },

    },
    props:{
     
    },
    updated(){

    },
    });

  };


 
</script>